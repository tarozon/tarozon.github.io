# 배경 적용 범위 vs 전역 오류 원인 정리 및 수정 플랜

## 1. "보드에만 사진 적용된 거 맞냐?" — 실제 구현 상태

**아니요. 보드만이 아니라 전체 앱에 적용돼 있습니다.**

| 적용 대상 | 코드 상 대상 | 의미 |
|-----------|----------------|------|
| 배경 이미지 | `.stApp` | Streamlit **앱 전체** 루트 컨테이너 (사이드바 + 메인 영역 모두 포함) |
| 어둡기 오버레이 | `.stApp::before` | 같은 전체 영역 위에 반투명 레이어 |
| 글래스 | `[data-testid="stSidebar"] > div`, `main .block-container` | 사이드바·메인을 반투명 패널로 덮음 |

- **배경은 `.stApp`에 한 번만 걸려 있어서**, 이론상 화면 전체 뒤에 깔려 있습니다.
- **보드에만 보이는 것처럼 느껴지는 이유**: 사이드바와 메인 영역에 글래스(반투명 + 블러)를 씌워서, 그 위쪽은 패널 색이 더 진하게 보이고, **보드(이미지/카드 영역) 쪽은 상대적으로 배경이 더 잘 비쳐 보일 수 있음**. 즉 “보드에만 적용된 것처럼 보이는” 건 시각적 효과일 뿐이고, **배경 자체는 앱 전체(.stApp)에 적용된 상태**가 맞습니다.

정리하면, **배경은 “보드 안에만” 적용된 게 아니라 “전체 앱”에 적용**돼 있고, 보이는 범위만 글래스 때문에 다르게 느껴지는 것입니다.

---

## 2. "왜 전체 오류가 나오지?" — 오류의 진짜 원인

**콘솔에 나오는 오류는 배경 이미지 CSS와 무관합니다.**  
오류는 **테마 설정(config.toml)** 에서 나옵니다.

- 메시지: `Invalid color passed for widgetBackgroundColor / widgetBorderColor / skeletonBackgroundColor in theme.sidebar: ""`
- 의미: **프론트엔드(JS)가 받는 `theme.sidebar` 객체 안의 위 세 색상 값이 빈 문자열 `""`** 이라서, “유효하지 않은 색”으로 처리되며 경고/오류가 나는 것입니다.
- **테마는 앱 전체에 한 번 로드되는 설정**이기 때문에, 이 오류도 **앱 전역(한 번)** 에서 찍히는 겁니다. “보드에만 스타일 넣었는데 왜 전역 오류가 나와?”가 아니라, **“테마는 원래 전역이라, 테마 쪽 문제는 전역 오류로 나온다”** 가 맞습니다.

즉:

- **배경 이미지** → `.stApp`에 전체 적용 (보드만 아님).
- **전역 오류** → **테마(config.toml)** 의 `theme.sidebar` 파생 색상이 `""` 로 넘어가서 발생 (배경 CSS와는 별개).

---

## 3. 왜 `[theme.sidebar]`를 넣었는데도 여전히 "" 가 나올까?

가능한 원인 두 가지입니다.

1. **Streamlit이 `base = "dark"` 일 때 `[theme.sidebar]`가 아니라 `[theme.dark.sidebar]` 를 참조하는 경우**  
   - 문서상으로는 `[theme.sidebar]`는 전역 사이드바 오버레이, `[theme.dark.sidebar]`는 다크 모드일 때만 쓰는 별도 테이블입니다.
   - 내부적으로 다크 모드일 때 `theme.dark` + `theme.dark.sidebar` 조합으로 색을 채우고, `theme.sidebar`만 있으면 그쪽 값이 안 쓰이거나, **파생 키(widgetBackgroundColor 등)가 채워지지 않아 `""` 로 내려갈 수 있음**.

2. **파생 키는 config 키와 1:1가 아님**  
   - `widgetBackgroundColor`, `widgetBorderColor`, `skeletonBackgroundColor` 는 문서에 없는 **내부 파생 키**일 수 있어서, `backgroundColor` / `secondaryBackgroundColor` / `borderColor` 만으로는 채워지지 않고, 특정 조건에서 `""` 가 될 수 있습니다.

그래서 **config로 “사이드바 테마를 완전히 채우는” 경로를 피하고**, **테마는 최소로 두고 색/배경은 CSS로만 넣는 쪽**이 안전합니다.

---

## 4. 수정 플랜 (요약)

**목표**

- 배경: 지금처럼 **전체 앱(.stApp)** 에 유지 (보드만이 아님).
- 오류 제거: **theme.sidebar 쪽에서 빈 문자열이 나오지 않게** 하기.

**방안 A: 테마 최소화 + CSS로만 색/배경 제어 (권장)**

- **config.toml**
  - `base = "light"` 로 되돌리거나, 아예 **theme 쪽 커스텀을 최소화** (primaryColor 정도만 두거나, 기본 light/dark만 사용).
  - **`[theme.sidebar]` 제거** (또는 `[theme.dark.sidebar]` 도 사용하지 않음).
- **app.py 주입 CSS**
  - 배경: 그대로 `.stApp` 에 고정 배경 이미지 + 오버레이.
  - 글자/위젯 색, 글래스, 테두리 등: **전부 CSS로만** 지정 (이미 상당 부분 적용된 상태).
- **효과**: Streamlit이 테마에서 사이드바용 파생 색을 만들 때, 우리가 건드리지 않아서 **빈 문자열이 나올 가능성을 줄임**. 시각적 결과는 CSS로 유지.

**방안 B: 다크 모드일 때 사이드바 테이블 명시**

- **config.toml**
  - `base = "dark"` 유지.
  - `[theme.sidebar]` 대신 **`[theme.dark.sidebar]`** 에만 동일 색상 지정 (backgroundColor, secondaryBackgroundColor, primaryColor, textColor, borderColor 등).
  - 필요하면 `[theme.sidebar]` 는 제거.
- **효과**: 다크 모드일 때 사용하는 테이블을 명시해, 파생 색이 채워지게 시도.  
  (Streamlit 버전/내부 구현에 따라 해결될 수도, 안 될 수도 있음.)

**방안 C: Streamlit 버전 확인 후 이슈 검색**

- `requirements.txt` 에서 streamlit 버전 확인 (현재는 버전 고정 없음).
- 해당 버전 + "theme.sidebar" / "widgetBackgroundColor" / "Invalid color" 로 이슈 검색해, 공식 쪽 수정/워크어라운드가 있는지 확인.

---

## 5. 권장 실행 순서

1. **방안 A 적용**: config 테마 최소화 + `[theme.sidebar]` 제거, 색/배경은 CSS만 사용.
2. 앱 재실행 후 F12 콘솔에서 `Invalid color ... theme.sidebar` 오류가 사라졌는지 확인.
3. 여전히 나오면 **방안 B** 시도: `[theme.dark.sidebar]` 만 명시.
4. 그래도 나오면 **방안 C**: Streamlit 버전 고정 후 이슈/문서 확인.

---

## 6. 한 줄 요약

- **배경**: 보드만이 아니라 **전체 앱(.stApp)** 에 적용된 것이 맞고, 보드에만 보이는 건 글래스 때문에 그렇게 보일 뿐이다.
- **전역 오류**: **테마(config.toml)의 theme.sidebar** 에서 색이 `""` 로 나와서 발생하는 것이므로, **테마를 건드리지 않고 CSS로만 스타일을 주면** 오류를 피할 수 있다.
